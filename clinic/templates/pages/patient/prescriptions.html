{% extends "pages/patient/P_base.html" %}
{% load static %}

{% block titles %}Prescription || Nepal's Care {% endblock titles %}

{% block styles %}

{% endblock styles %}


{% block pageof %} Prescription {% endblock pageof %}
{% block linkPageof %} /p/prescriptions/ {% endblock linkPageof %}

{% block content %}
<div class="flex flex-col w-full max-w-6xl mx-auto min-h-screen p-6">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Prescriptions Management</h1>

    <!-- Overview Panel -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white p-4 rounded-lg shadow flex items-center space-x-4 border-l-4 border-green-500">
            <div class="p-3 bg-green-100 rounded-full">
                <svg id='Pill_24' class="w-6 h-6 text-green-600" fill="currentColor" viewBox='0 0 24 24'
                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.3 0 0 0.3 12 12)">
                        <path
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: nonzero; opacity: 1;"
                            transform=" translate(-40, -40)"
                            d="M 56 7 C 51.3125 7 47.054688 8.902344 43.980469 11.980469 L 11.480469 44.480469 C 11.382813 44.574219 11.308594 44.691406 11.257813 44.816406 C 8.632813 47.804688 7 51.707031 7 56 C 7 65.378906 14.621094 73 24 73 C 28.292969 73 32.195313 71.367188 35.1875 68.742188 C 35.3125 68.691406 35.425781 68.617188 35.519531 68.519531 L 68.019531 36.019531 C 71.097656 32.945313 73 28.6875 73 24 C 73 14.621094 65.378906 7 56 7 Z M 56 9 C 64.296875 9 71 15.703125 71 24 C 71 28.148438 69.324219 31.890625 66.609375 34.609375 L 51.3125 49.902344 L 30.097656 28.6875 L 45.390625 13.390625 C 48.109375 10.675781 51.851563 9 56 9 Z M 56 12 C 55.449219 12 55 12.449219 55 13 C 55 13.550781 55.449219 14 56 14 C 56.550781 14 57 13.550781 57 13 C 57 12.449219 56.550781 12 56 12 Z M 51.796875 12.835938 C 51.664063 12.835938 51.53125 12.859375 51.40625 12.910156 C 50.894531 13.125 50.652344 13.707031 50.863281 14.21875 C 51.078125 14.730469 51.660156 14.972656 52.171875 14.761719 C 52.683594 14.546875 52.925781 13.964844 52.714844 13.453125 C 52.558594 13.082031 52.199219 12.839844 51.796875 12.835938 Z M 60.230469 12.835938 C 59.816406 12.828125 59.441406 13.070313 59.285156 13.453125 C 59.074219 13.964844 59.316406 14.546875 59.828125 14.761719 C 60.335938 14.972656 60.921875 14.730469 61.132813 14.21875 C 61.34375 13.707031 61.101563 13.125 60.59375 12.910156 C 60.476563 12.863281 60.355469 12.839844 60.230469 12.835938 Z M 48.234375 15.222656 C 47.964844 15.21875 47.707031 15.324219 47.515625 15.515625 C 47.125 15.90625 47.125 16.539063 47.515625 16.929688 C 47.90625 17.320313 48.539063 17.320313 48.929688 16.929688 C 49.320313 16.539063 49.320313 15.90625 48.929688 15.515625 C 48.746094 15.332031 48.496094 15.226563 48.234375 15.222656 Z M 45 18 C 44.449219 18 44 18.449219 44 19 C 44 19.550781 44.449219 20 45 20 C 45.550781 20 46 19.550781 46 19 C 46 18.449219 45.550781 18 45 18 Z M 42 21 C 41.449219 21 41 21.449219 41 22 C 41 22.550781 41.449219 23 42 23 C 42.550781 23 43 22.550781 43 22 C 43 21.449219 42.550781 21 42 21 Z M 39 24 C 38.449219 24 38 24.449219 38 25 C 38 25.550781 38.449219 26 39 26 C 39.550781 26 40 25.550781 40 25 C 40 24.449219 39.550781 24 39 24 Z M 36 27 C 35.449219 27 35 27.449219 35 28 C 35 28.550781 35.449219 29 36 29 C 36.550781 29 37 28.550781 37 28 C 37 27.449219 36.550781 27 36 27 Z M 28.6875 30.097656 L 49.902344 51.3125 L 34.296875 66.921875 L 34.292969 66.921875 C 34.226563 66.960938 34.167969 67.003906 34.113281 67.050781 C 31.441406 69.5 27.90625 71 24 71 C 15.703125 71 9 64.296875 9 56 C 9 52.09375 10.5 48.558594 12.949219 45.886719 C 12.996094 45.832031 13.035156 45.773438 13.074219 45.714844 Z M 28 35 C 27.449219 35 27 35.449219 27 36 C 27 36.550781 27.449219 37 28 37 C 28.550781 37 29 36.550781 29 36 C 29 35.449219 28.550781 35 28 35 Z M 25 38 C 24.449219 38 24 38.449219 24 39 C 24 39.550781 24.449219 40 25 40 C 25.550781 40 26 39.550781 26 39 C 26 38.449219 25.550781 38 25 38 Z M 22 41 C 21.449219 41 21 41.449219 21 42 C 21 42.550781 21.449219 43 22 43 C 22.550781 43 23 42.550781 23 42 C 23 41.449219 22.550781 41 22 41 Z M 19 44 C 18.449219 44 18 44.449219 18 45 C 18 45.550781 18.449219 46 19 46 C 19.550781 46 20 45.550781 20 45 C 20 44.449219 19.550781 44 19 44 Z M 16.234375 47.21875 C 15.964844 47.214844 15.703125 47.320313 15.515625 47.515625 C 15.125 47.902344 15.125 48.539063 15.515625 48.925781 C 15.703125 49.117188 15.957031 49.222656 16.222656 49.222656 C 16.488281 49.222656 16.742188 49.117188 16.929688 48.925781 C 17.320313 48.539063 17.320313 47.902344 16.929688 47.515625 C 16.746094 47.328125 16.496094 47.222656 16.234375 47.21875 Z M 13.859375 50.792969 C 13.445313 50.78125 13.070313 51.027344 12.914063 51.40625 C 12.703125 51.917969 12.945313 52.503906 13.453125 52.714844 C 13.699219 52.816406 13.976563 52.816406 14.222656 52.714844 C 14.464844 52.613281 14.660156 52.417969 14.761719 52.171875 C 14.863281 51.925781 14.863281 51.652344 14.761719 51.40625 C 14.660156 51.160156 14.464844 50.964844 14.21875 50.863281 C 14.105469 50.820313 13.984375 50.792969 13.859375 50.792969 Z M 13 55 C 12.449219 55 12 55.449219 12 56 C 12 56.550781 12.449219 57 13 57 C 13.550781 57 14 56.550781 14 56 C 14 55.449219 13.550781 55 13 55 Z M 13.84375 59.207031 C 13.710938 59.207031 13.578125 59.234375 13.453125 59.285156 C 12.945313 59.496094 12.703125 60.082031 12.914063 60.59375 C 13.125 61.101563 13.710938 61.34375 14.21875 61.132813 C 14.730469 60.921875 14.972656 60.335938 14.761719 59.828125 C 14.609375 59.457031 14.246094 59.210938 13.84375 59.207031 Z"
                            stroke-linecap="round" />
                    </g>
                </svg>
            </div>
            <div>
                <p class="text-sm text-gray-500">Active Prescriptions</p>
                <p class="text-2xl font-bold">3</p>
            </div>
        </div>

        <div class="bg-white p-4 rounded-lg shadow flex items-center space-x-4 border-l-4 border-yellow-500">
            <div class="p-3 bg-yellow-100 rounded-full">
                <svg id='Refresh_24' class="w-6 h-6 text-yellow-600" fill="currentColor" viewBox='0 0 24 24'
                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.67 0 0 0.67 12 12)">
                        <path
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: nonzero; opacity: 1;"
                            transform=" translate(-15, -15)"
                            d="M 15 3 C 12.031398 3 9.3028202 4.0834384 7.2070312 5.875 C 6.92097953443116 6.102722442718219 6.781996312146395 6.468394217532747 6.84458079887411 6.828625043966701 C 6.907165285601823 7.188855870400655 7.161341070445081 7.486222400749947 7.507438614792125 7.604118779359328 C 7.8535361591391695 7.722015157968709 8.236385060652946 7.641647866224133 8.5058594 7.394531200000001 C 10.25407 5.9000929 12.516602 5 15 5 C 20.19656 5 24.450989 8.9379267 24.951172 14 L 22 14 L 26 20 L 30 14 L 26.949219 14 C 26.437925 7.8516588 21.277839 3 15 3 z M 4 10 L 0 16 L 3.0507812 16 C 3.562075 22.148341 8.7221607 27 15 27 C 17.968602 27 20.69718 25.916562 22.792969 24.125 C 23.07902234348135 23.89727811487935 23.21800696636432 23.531605633011267 23.155422803510252 23.17137377040107 C 23.092838640656183 22.811141907790866 22.838662106347986 22.51377449397328 22.492563490644887 22.395878266348475 C 22.14646487494179 22.27798203872367 21.76361505519577 22.35835059547272 21.494141 22.605469 C 19.74593 24.099907 17.483398 25 15 25 C 9.80344 25 5.5490109 21.062074 5.0488281 16 L 8 16 L 4 10 z"
                            stroke-linecap="round" />
                    </g>
                </svg>
            </div>
            <div>
                <p class="text-sm text-gray-500">Pending Refills</p>
                <p class="text-2xl font-bold">1</p>
            </div>
        </div>

        <div class="bg-white p-4 rounded-lg shadow flex items-center space-x-4 border-l-4 border-blue-500">
            <div class="p-3 bg-blue-100 rounded-full">
                <svg id='Clock_24' class="w-6 h-6 text-blue-600" fill="currentColor" viewBox='0 0 24 24'
                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.83 0 0 0.83 12 12)">
                        <path
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;"
                            transform=" translate(-16, -16)"
                            d="M 16 4 C 9.382813 4 4 9.382813 4 16 C 4 22.617188 9.382813 28 16 28 C 22.617188 28 28 22.617188 28 16 C 28 9.382813 22.617188 4 16 4 Z M 16 6 C 21.535156 6 26 10.464844 26 16 C 26 21.535156 21.535156 26 16 26 C 10.464844 26 6 21.535156 6 16 C 6 10.464844 10.464844 6 16 6 Z M 15 8 L 15 17 L 22 17 L 22 15 L 17 15 L 17 8 Z"
                            stroke-linecap="round" />
                    </g>
                </svg>
            </div>
            <div>
                <p class="text-sm text-gray-500">Recent Orders</p>
                <p class="text-2xl font-bold">2</p>
            </div>
        </div>

        <div class="bg-white p-4 rounded-lg shadow flex items-center space-x-4 border-l-4 border-red-500">
            <div class="p-3 bg-red-100 rounded-full">
                <svg id='Alert_Warning_Circle_24' class="w-6 h-6 text-red-600" fill="currentColor" viewBox='0 0 24 24'
                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(1.43 0 0 1.43 12 12)">
                        <g style="">
                            <g transform="matrix(1 0 0 1 0 0)">
                                <circle
                                    style="stroke: currentColor; stroke-width: 1; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                    cx="0" cy="0" r="6.5" />
                            </g>
                            <g transform="matrix(1 0 0 1 0 -2)">
                                <line
                                    style="stroke: currentColor; stroke-width: 1; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                    x1="0" y1="-1.5" x2="0" y2="1.5" />
                            </g>
                            <g transform="matrix(1 0 0 1 0 2.5)">
                                <circle
                                    style="stroke: currentColor; stroke-width: 1; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                    cx="0" cy="0" r="0.5" />
                            </g>
                        </g>
                    </g>
                </svg>
            </div>
            <div>
                <p class="text-sm text-gray-500">Alerts</p>
                <p class="text-2xl font-bold">1</p>
            </div>
        </div>
    </div>

    <div class="flex flex-col  gap-6">
        <!-- Main Content -->
        <div class="flex-1">
            <!-- Tabs -->
            <div class="flex mb-4 border-b">
                <button class="px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600" id="tab-active">
                    Active Prescriptions
                </button>
                <button class="px-4 py-2 font-medium text-gray-500" id="tab-history">
                    Prescription History
                </button>
            </div>

            <!-- Prescriptions List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <!-- Active Prescriptions Table -->
                <div id="active-prescriptions-table" class="overflow-x-scroll custom-scrollbar">
                    <table class="min-w-full divide-y  divide-gray-200 ">
                        <thead class="bg-gray-50">
                            <tr>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Medication</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Dosage</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Prescribed By</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Duration</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Status</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Action</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200 " id="active-prescriptions-body">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <!-- History Prescriptions Table -->
                <div id="history-prescriptions-table" class="hidden overflow-x-scroll custom-scrollbar">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Medication</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Dosage</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Prescribed By</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Period</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Status</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Reason</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="history-prescriptions-body">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Sidebar - Medication Insights & Reminders -->
        <div class="w-full md:w-80 space-y-6">
            <!-- Daily Medication Schedule -->
            <div class="bg-white rounded-lg shadow p-4">
                <h3 class="text-lg font-medium text-gray-800 mb-4">Today's Medications</h3>
                <div class="space-y-3" id="today-medications">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <!-- Warnings -->
            <!-- <div class="bg-white rounded-lg shadow p-4">
                <h3 class="text-lg font-medium text-gray-800 mb-4">Important Notices</h3>
                <div class="space-y-3">
                    <div class="flex items-start p-3 bg-yellow-50 rounded border-l-4 border-yellow-400">
                        <svg id='alert-triangle_24' class="h-5 w-5 text-yellow-500 mr-2 flex-shrink-0"
                            fill="currentColor" stroke="currentColor" viewBox='0 0 24 24'
                            xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                            <g transform="matrix(1 0 0 1 12 12)">
                                <g style="">
                                    <g transform="matrix(1 0 0 1 0 0)">
                                        <path
                                            style="stroke: none; stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            transform=" translate(-12, -12)" d="M 0 0 L 24 0 L 24 24 L 0 24 z"
                                            stroke-linecap="round" />
                                    </g>
                                    <g transform="matrix(1 0 0 1 0 0)">
                                        <path
                                            style=" stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            transform=" translate(-12, -12)" d="M 12 9 L 12 11 M 12 15 L 12 15.01"
                                            stroke-linecap="round" />
                                    </g>
                                    <g transform="matrix(1 0 0 1 -0.01 -1.02)">
                                        <path
                                            style=" stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            transform=" translate(-11.99, -10.98)"
                                            d="M 5 19 L 19 19 C 19.66253481931263 18.995352298279364 20.279767784755453 18.66289677171885 20.648208688001613 18.112237813062897 C 21.016649591247777 17.56157885440695 21.08847297205671 16.86419473303685 20.84 16.25 L 13.74 4 C 13.387762321350626 3.3633683571193016 12.717579020435085 2.968245836551854 11.99 2.968245836551854 C 11.262420979564915 2.968245836551854 10.592237678649374 3.3633683571193016 10.24 4 L 3.1400000000000006 16.25 C 2.8963959721327526 16.849734806693284 2.958120473472632 17.5302836898311 3.3056513716070226 18.076403672613715 C 3.6531822697414134 18.62252365539633 4.243537351545838 18.966671260056703 4.890000000000001 19"
                                            stroke-linecap="round" />
                                    </g>
                                </g>
                            </g>
                        </svg>
                        <div>
                            <p class="text-sm font-medium text-yellow-800">Potential Interaction</p>
                            <p class="text-xs text-yellow-700 mt-1">Amlodipine and Atorvastatin may interact. Take
                                at least 2 hours apart.</p>
                        </div>
                    </div>
                    <div class="flex items-start p-3 bg-blue-50 rounded border-l-4 border-blue-400">
                        <svg id='alert-circle_24' class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0" fill="currentColor"
                            stroke="currentColor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'
                            xmlns:xlink='http://www.w3.org/1999/xlink'>
                            <g transform="matrix(1 0 0 1 12 12)">
                                <g style="">
                                    <g transform="matrix(1 0 0 1 0 0)">
                                        <path
                                            style="stroke: none; stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            transform=" translate(-12, -12)" d="M 0 0 L 24 0 L 24 24 L 0 24 z"
                                            stroke-linecap="round" />
                                    </g>
                                    <g transform="matrix(1 0 0 1 0 0)">
                                        <circle
                                            style=" stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            cx="0" cy="0" r="9" />
                                    </g>
                                    <g transform="matrix(1 0 0 1 0 -2)">
                                        <line
                                            style=" stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            x1="0" y1="-2" x2="0" y2="2" />
                                    </g>
                                    <g transform="matrix(1 0 0 1 0 4)">
                                        <line
                                            style=" stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;"
                                            x1="-0.004999999999999893" y1="0" x2="0.004999999999999893" y2="0" />
                                    </g>
                                </g>
                            </g>
                        </svg>



                        <div>
                            <p class="text-sm font-medium text-blue-800">Medication Tip</p>
                            <p class="text-xs text-blue-700 mt-1">Take Metformin with food to reduce stomach
                                discomfort.</p>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>
</div>



{% endblock content %}


{% block scripts %}
<!-- JavaScript -->
<script>

    // Sample data
    {% comment %} const activePrescriptions = [
        { id: 1, name: 'Amlodipine', dosage: '10mg', frequency: 'Once daily', doctor: 'Dr. Sarah Johnson', specialty: 'Cardiology', startDate: '2025-01-15', endDate: '2025-04-15', status: 'Active', refillStatus: 'Available', instructions: 'Take with or without food, at the same time each day. Avoid grapefruit products.', sideEffects: 'May cause dizziness, swelling in ankles, or headache.' },
        { id: 2, name: 'Metformin', dosage: '500mg', frequency: 'Twice daily', doctor: 'Dr. Michael Chen', specialty: 'Endocrinology', startDate: '2025-02-10', endDate: '2025-05-10', status: 'Active', refillStatus: 'Pending', instructions: 'Take with meals to reduce stomach upset. Monitor blood sugar regularly.', sideEffects: 'May cause nausea, diarrhea, or decreased vitamin B12 levels with long-term use.' },
        { id: 3, name: 'Atorvastatin', dosage: '20mg', frequency: 'Once daily', doctor: 'Dr. Sarah Johnson', specialty: 'Cardiology', startDate: '2025-01-15', endDate: '2025-07-15', status: 'Active', refillStatus: 'Expiring Soon', instructions: 'Take in the evening. Avoid consuming large amounts of grapefruit juice.', sideEffects: 'May cause muscle pain, weakness, or liver problems.' }
    ];

    const historyPrescriptions = [
        { id: 4, name: 'Amoxicillin', dosage: '500mg', frequency: 'Three times daily', doctor: 'Dr. James Wilson', specialty: 'General Practice', startDate: '2024-12-05', endDate: '2024-12-15', status: 'Completed', reason: 'Full course completed' },
        { id: 5, name: 'Prednisone', dosage: '20mg tapering', frequency: 'Per schedule', doctor: 'Dr. Emily Roberts', specialty: 'Rheumatology', startDate: '2024-11-10', endDate: '2024-12-22', status: 'Discontinued', reason: 'Side effects (insomnia, mood changes)' }
    ]; {% endcomment %}

    const activePrescriptions ={{ merged_json_data.active_data|safe}};
    const historyPrescriptions = {{ merged_json_data.history_data|safe}};

    // Today's medications
    const todayMedications = [
        { name: 'Amlodipine', time: '8:00 AM', taken: true },
        { name: 'Metformin', time: '8:00 AM', taken: true },
        { name: 'Metformin', time: '8:00 PM', taken: false },
        { name: 'Atorvastatin', time: '8:00 PM', taken: false },
    ];

    // Status badge helper function
    function getStatusBadgeHTML(status) {
        let colorClass = '';
        switch (status) {
            case 'Active':
                colorClass = 'bg-green-100 text-green-800';
                break;
            case 'Pending':
                colorClass = 'bg-yellow-100 text-yellow-800';
                break;
            case 'Expiring Soon':
                colorClass = 'bg-orange-100 text-orange-800';
                break;
            case 'Completed':
                colorClass = 'bg-blue-100 text-blue-800';
                break;
            case 'Discontinued':
                colorClass = 'bg-red-100 text-red-800';
                break;
            default:
                colorClass = 'bg-gray-100 text-gray-800';
        }
        return `<span class="px-2 py-1 text-xs font-medium rounded-full ${colorClass}">${status}</span>`;
    }

    // Format a date string
    function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString();
    }

    // Render active prescriptions
    function renderActivePrescriptions() {
        const tableBody = document.getElementById('active-prescriptions-body');
        tableBody.innerHTML = '';

        activePrescriptions.forEach(prescription => {
            // Create main row
            const mainRow = document.createElement('tr');
            mainRow.className = 'hover:bg-gray-50';
            mainRow.dataset.id = prescription.id;

            mainRow.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-100 rounded-full">
                                <svg id='Pill_24' class="h-5 w-5 text-blue-600" fill="currentcolor" viewBox='0 0 24 24' 
                                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>

                                    <g transform="matrix(0.83 0 0 0.83 12 12)" >
                                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: nonzero; opacity: 1;" transform=" translate(-15, -14.98)" d="M 19.636719 3.0058594 C 17.749977 3.0058594 15.863309 3.7226272 14.429688 5.15625 L 5.15625 14.429688 C 2.2890045 17.296932 2.2890045 21.976504 5.15625 24.84375 C 5.249623121478076 24.936806155451993 5.360472242339778 25.010484350463443 5.4824219 25.060547 C 5.484372985183456 25.061204029240233 5.4863260944944106 25.06185503234373 5.4882812 25.0625 C 8.3730664 27.643444 12.800719 27.613345 15.570312 24.84375 L 24.84375 15.570312 C 27.710996 12.703067 27.710996 8.0234955 24.84375 5.15625 C 23.410126 3.7225802 21.523461 3.0058594 19.636719 3.0058594 z M 19.636719 4.9941406 C 21.007477 4.9941406 22.37831 5.5189353 23.429688 6.5703125 C 25.532442 8.673067 25.532442 12.053496 23.429688 14.15625 L 21.292969 16.292969 L 19.5 18.085938 C 19.109 18.476937 18.477891 18.477891 18.087891 18.087891 C 16.762891 16.761891 14.033203 14.03125 14.033203 14.03125 L 14.03125 14.03125 C 13.2502359867062 13.250402811482466 11.984139013293799 13.250402811482466 11.203125 14.031250000000002 L 8.0117188 17.226562 C 7.6207187 17.617562 6.9876562 17.617562 6.5976562 17.226562 C 6.2101235 16.83903 6.209184 16.214994 6.5898438 15.824219 L 15.84375 6.5703125 C 16.895127 5.5189353 18.265961 4.9941406 19.636719 4.9941406 z" stroke-linecap="round" />
                                    </g>
                                </svg>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${prescription.name}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${prescription.dosage}</div>
                        <div class="text-sm text-gray-500">${prescription.frequency}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${prescription.doctor}</div>
                        <div class="text-sm text-gray-500">${prescription.specialty}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">
                            <div class="flex items-center">
                                <svg id='Calendar_24' class="h-4 w-4 mr-1 text-gray-500" fill="currentcolor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                    <g transform="matrix(1 0 0 1 12 12)" >
                                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -11)" d="M 6 1 L 6 3 L 5 3 C 3.9 3 3 3.9 3 5 L 3 19 C 3 20.1 3.9 21 5 21 L 19 21 C 20.1 21 21 20.1 21 19 L 21 5 C 21 3.9 20.1 3 19 3 L 18 3 L 18 1 L 16 1 L 16 3 L 8 3 L 8 1 L 6 1 z M 5 8 L 19 8 L 19 19 L 5 19 L 5 8 z" stroke-linecap="round" />
                                    </g>
                                </svg>
                                <span>${formatDate(prescription.startDate)}</span>
                            </div>
                            <div class="flex items-center">
                                <svg id='Calendar_24' class="h-4 w-4 mr-1 text-gray-500" fill="currentcolor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                    <g transform="matrix(1 0 0 1 12 12)" >
                                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -11)" d="M 6 1 L 6 3 L 5 3 C 3.9 3 3 3.9 3 5 L 3 19 C 3 20.1 3.9 21 5 21 L 19 21 C 20.1 21 21 20.1 21 19 L 21 5 C 21 3.9 20.1 3 19 3 L 18 3 L 18 1 L 16 1 L 16 3 L 8 3 L 8 1 L 6 1 z M 5 8 L 19 8 L 19 19 L 5 19 L 5 8 z" stroke-linecap="round" />
                                    </g>
                                </svg>
                                <span>${formatDate(prescription.endDate)}</span>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${getStatusBadgeHTML(prescription.refillStatus)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button 
                            onclick="toggleDetails(${prescription.id})"
                            class="text-blue-600 hover:text-blue-900 flex items-center details-btn"
                            data-id="${prescription.id}"
                        >
                            Details <svg id='Chevron_Down_24' class="ml-1 h-4 w-4"  fill='currentcolor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.83 0 0 0.83 12 12)" >
                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-15, -15.5)" d="M 3 12 L 3 10 C 3 9.614 3.223 9.262 3.572 9.096 C 3.9210000000000003 8.93 4.334 8.981 4.634 9.226 L 15 17.708 L 25.367 9.225999999999999 C 25.666 8.981 26.079 8.931 26.429000000000002 9.095999999999998 C 26.779 9.261 27 9.614 27 10 L 27 12 C 27 12.3 26.865 12.584 26.633 12.774000000000001 L 15.633 21.774 C 15.264 22.075 14.735 22.075 14.366 21.774 L 3.3659999999999997 12.774000000000001 C 3.135 12.584 3 12.3 3 12 z" stroke-linecap="round" />
                    </g>
                </svg>
                        </button>
                    </td>
                `;

            tableBody.appendChild(mainRow);

            // Create details row (initially hidden)
            const detailsRow = document.createElement('tr');
            detailsRow.className = 'details-row hidden';
            detailsRow.dataset.id = prescription.id;

            detailsRow.innerHTML = `
                    <td colspan="6" class="px-6 py-4 bg-gray-50 border-t border-gray-100">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-medium text-gray-700 mb-2">Instructions</h4>
                                <p class="text-sm text-gray-600">${prescription.instructions}</p>
                                
                                <h4 class="font-medium text-gray-700 mt-4 mb-2">Possible Side Effects</h4>
                                <p class="text-sm text-gray-600">${prescription.sideEffects}</p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-700 mb-2">Actions</h4>
                                <div class="flex flex-col space-y-2">
                                    <button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700">
                                        <svg id='Refresh_24' class="w-4 h-4 mr-2" fill="currentColor" viewBox='0 0 24 24'
                                            xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                            <g transform="matrix(0.67 0 0 0.67 12 12)">
                                                <path
                                                    style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: nonzero; opacity: 1;"
                                                    transform=" translate(-15, -15)"
                                                    d="M 15 3 C 12.031398 3 9.3028202 4.0834384 7.2070312 5.875 C 6.92097953443116 6.102722442718219 6.781996312146395 6.468394217532747 6.84458079887411 6.828625043966701 C 6.907165285601823 7.188855870400655 7.161341070445081 7.486222400749947 7.507438614792125 7.604118779359328 C 7.8535361591391695 7.722015157968709 8.236385060652946 7.641647866224133 8.5058594 7.394531200000001 C 10.25407 5.9000929 12.516602 5 15 5 C 20.19656 5 24.450989 8.9379267 24.951172 14 L 22 14 L 26 20 L 30 14 L 26.949219 14 C 26.437925 7.8516588 21.277839 3 15 3 z M 4 10 L 0 16 L 3.0507812 16 C 3.562075 22.148341 8.7221607 27 15 27 C 17.968602 27 20.69718 25.916562 22.792969 24.125 C 23.07902234348135 23.89727811487935 23.21800696636432 23.531605633011267 23.155422803510252 23.17137377040107 C 23.092838640656183 22.811141907790866 22.838662106347986 22.51377449397328 22.492563490644887 22.395878266348475 C 22.14646487494179 22.27798203872367 21.76361505519577 22.35835059547272 21.494141 22.605469 C 19.74593 24.099907 17.483398 25 15 25 C 9.80344 25 5.5490109 21.062074 5.0488281 16 L 8 16 L 4 10 z"
                                                    stroke-linecap="round" />
                                            </g>
                                        </svg> Request Refill
                                    </button>
                                    <button class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                                        <svg id='file-text_24' class="mr-2 h-4 w-4" fill="currentcolor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                                        <g transform="matrix(1 0 0 1 12 12)" >
                                                        <g style="" >
                                                        <g transform="matrix(1 0 0 1 0 0)" >
                                                        <path style="stroke: none; stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -12)" d="M 0 0 L 24 0 L 24 24 L 0 24 z" stroke-linecap="round" />
                                                        </g>
                                                        <g transform="matrix(1 0 0 1 4.5 -6.5)" >
                                                        <path style="stroke: rgb(33,33,33); stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-16.5, -5.5)" d="M 14 3 L 14 7 C 14 7.552284749830793 14.447715250169207 8 15 8 L 19 8" stroke-linecap="round" />
                                                        </g>
                                                        <g transform="matrix(1 0 0 1 0 0)" >
                                                        <path style="stroke: rgb(33,33,33); stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -12)" d="M 17 21 L 7 21 C 5.8954305003384135 21 5 20.104569499661586 5 19 L 5 5 C 5 3.895430500338413 5.8954305003384135 3 7 3 L 14 3 L 19 8 L 19 19 C 19 20.104569499661586 18.104569499661586 21 17 21 z" stroke-linecap="round" />
                                                        </g>
                                                        <g transform="matrix(1 0 0 1 -2.5 -3)" >
                                                        <line style="stroke: rgb(33,33,33); stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" x1="-0.5" y1="0" x2="0.5" y2="0" />
                                                        </g>
                                                        <g transform="matrix(1 0 0 1 0 1)" >
                                                        <line style="stroke: rgb(33,33,33); stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" x1="-3" y1="0" x2="3" y2="0" />
                                                        </g>
                                                        <g transform="matrix(1 0 0 1 0 5)" >
                                                        <line style="stroke: rgb(33,33,33); stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" x1="-3" y1="0" x2="3" y2="0" />
                                                        </g>
                                                        </g>
                                                        </g>
                                        </svg>
                                        
                                        
                                        View Full Details
                                    </button>
                                    <button class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                                        <svg id='message-circle-2_24' class="mr-2 h-4 w-4" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                            <g transform="matrix(1 0 0 1 12 12)" >
                                            <g style="" >
                                            <g transform="matrix(1 0 0 1 0 0)" >
                                            <path style="stroke: none; stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -12)" d="M 0 0 L 24 0 L 24 24 L 0 24 z" stroke-linecap="round" />
                                            </g>
                                            <g transform="matrix(1 0 0 1 0.01 -0.01)" >
                                            <path style="stroke: rgb(33,33,33); stroke-width: 2; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-12.01, -11.99)" d="M 3 20 L 4.3 16.1 C 1.9761174147637677 12.663009706393852 2.8738762839310747 8.227707321782525 6.399767548460441 5.726274565848396 C 9.92565881298981 3.224841809914267 14.990227941838622 3.430188862125 18.245284500640466 6.206560632867749 C 21.50034105944231 8.982932403610498 21.940114917829877 13.472466134630796 19.273871249507618 16.70712772262393 C 16.607627581185362 19.94178931061706 11.65920099345933 20.92211040586947 7.700000000000003 19 L 2.999999999999999 20" stroke-linecap="round" />
                                            </g>
                                            </g>
                                            </g>
                                        </svg>
                                        
                                        
                                        Report Issue
                                    </button>
                                </div>
                            </div>
                        </div>
                    </td>
                `;

            tableBody.appendChild(detailsRow);
        });

        // Re-initialize Lucide icons since we added new ones
    }

    // Render history prescriptions
    function renderHistoryPrescriptions() {
        const tableBody = document.getElementById('history-prescriptions-body');
        tableBody.innerHTML = '';

        historyPrescriptions.forEach(prescription => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50';

            row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 flex items-center justify-center bg-gray-100 rounded-full">
                                <svg id='Pill_24' class="h-5 w-5 text-gray-600" fill="currentcolor" viewBox='0 0 24 24'
                                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>

                                    <g transform="matrix(0.83 0 0 0.83 12 12)" >
                                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: nonzero; opacity: 1;" transform=" translate(-15, -14.98)" d="M 19.636719 3.0058594 C 17.749977 3.0058594 15.863309 3.7226272 14.429688 5.15625 L 5.15625 14.429688 C 2.2890045 17.296932 2.2890045 21.976504 5.15625 24.84375 C 5.249623121478076 24.936806155451993 5.360472242339778 25.010484350463443 5.4824219 25.060547 C 5.484372985183456 25.061204029240233 5.4863260944944106 25.06185503234373 5.4882812 25.0625 C 8.3730664 27.643444 12.800719 27.613345 15.570312 24.84375 L 24.84375 15.570312 C 27.710996 12.703067 27.710996 8.0234955 24.84375 5.15625 C 23.410126 3.7225802 21.523461 3.0058594 19.636719 3.0058594 z M 19.636719 4.9941406 C 21.007477 4.9941406 22.37831 5.5189353 23.429688 6.5703125 C 25.532442 8.673067 25.532442 12.053496 23.429688 14.15625 L 21.292969 16.292969 L 19.5 18.085938 C 19.109 18.476937 18.477891 18.477891 18.087891 18.087891 C 16.762891 16.761891 14.033203 14.03125 14.033203 14.03125 L 14.03125 14.03125 C 13.2502359867062 13.250402811482466 11.984139013293799 13.250402811482466 11.203125 14.031250000000002 L 8.0117188 17.226562 C 7.6207187 17.617562 6.9876562 17.617562 6.5976562 17.226562 C 6.2101235 16.83903 6.209184 16.214994 6.5898438 15.824219 L 15.84375 6.5703125 C 16.895127 5.5189353 18.265961 4.9941406 19.636719 4.9941406 z" stroke-linecap="round" />
                                    </g>
                                </svg>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${prescription.name}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${prescription.dosage}</div>
                        <div class="text-sm text-gray-500">${prescription.frequency}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${prescription.doctor}</div>
                        <div class="text-sm text-gray-500">${prescription.specialty}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">
                            <div class="flex items-center">
                                <svg id='Calendar_24' class="h-4 w-4 mr-1 text-gray-500" fill="currentcolor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                    <g transform="matrix(1 0 0 1 12 12)" >
                                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -11)" d="M 6 1 L 6 3 L 5 3 C 3.9 3 3 3.9 3 5 L 3 19 C 3 20.1 3.9 21 5 21 L 19 21 C 20.1 21 21 20.1 21 19 L 21 5 C 21 3.9 20.1 3 19 3 L 18 3 L 18 1 L 16 1 L 16 3 L 8 3 L 8 1 L 6 1 z M 5 8 L 19 8 L 19 19 L 5 19 L 5 8 z" stroke-linecap="round" />
                                    </g>
                                </svg>
                                <span>${formatDate(prescription.startDate)}</span>
                            </div>
                            <div class="flex items-center">
                                <svg id='Calendar_24' class="h-4 w-4 mr-1 text-gray-500" fill="currentcolor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                                    <g transform="matrix(1 0 0 1 12 12)" >
                                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-12, -11)" d="M 6 1 L 6 3 L 5 3 C 3.9 3 3 3.9 3 5 L 3 19 C 3 20.1 3.9 21 5 21 L 19 21 C 20.1 21 21 20.1 21 19 L 21 5 C 21 3.9 20.1 3 19 3 L 18 3 L 18 1 L 16 1 L 16 3 L 8 3 L 8 1 L 6 1 z M 5 8 L 19 8 L 19 19 L 5 19 L 5 8 z" stroke-linecap="round" />
                                    </g>
                                </svg>
                                <span>${formatDate(prescription.endDate)}</span>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${getStatusBadgeHTML(prescription.status)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${prescription.reason}
                    </td>
                `;

            tableBody.appendChild(row);
        });

        // Re-initialize Lucide icons
    }

    // Render today's medications
    function renderTodayMedications() {
        const container = document.getElementById('today-medications');
        container.innerHTML = '';

        todayMedications.forEach((med, index) => {
            const div = document.createElement('div');
            div.className = 'flex items-center justify-between p-2 rounded hover:bg-gray-50';

            div.innerHTML = `
                    <div class="flex items-center">
                        ${med.taken ?
                    `                    
                    <svg id='Validation_Check_Circle_24' class="h-5 w-5 text-green-500 mr-2" fill="currentcolor" stroke="currentcolor" viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                        <g transform="matrix(1.43 0 0 1.43 12 12)" >
                        <g style="" >
                        <g transform="matrix(1 0 0 1 -0.5 0.5)" >
                        <path style=" stroke-width: 1; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-6.5, -7.5)" d="M 12.0524 6 C 12.1813 6.47821 12.25 6.98107 12.25 7.5 C 12.25 10.6756 9.67564 13.25 6.5 13.25 C 3.32436 13.25 0.75 10.6756 0.75 7.5 C 0.75 4.32436 3.32436 1.75 6.5 1.75 C 6.9459 1.75 7.37994 1.80075 7.79667 1.8968" stroke-linecap="round" />
                        </g>
                        <g transform="matrix(1 0 0 1 1 -1.5)" >
                        <path style=" stroke-width: 1; stroke-dasharray: none; stroke-linecap: round; stroke-dashoffset: 0; stroke-linejoin: round; stroke-miterlimit: 4; fill: none; fill-rule: nonzero; opacity: 1;" transform=" translate(-8, -5.5)" d="M 4 6.5 L 6.90909 9.5 C 8.278 5.56771 9.41805 3.84218 12 1.5" stroke-linecap="round" />
                        </g>
                        </g>
                        </g>
                    </svg>
                    
                    
                    ` :
                    `
                    
                     <svg id='Clock_24' class="h-5 w-5 text-blue-500 mr-2" fill="currentColor" viewBox='0 0 24 24'
                    xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.83 0 0 0.83 12 12)">
                        <path
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;"
                            transform=" translate(-16, -16)"
                            d="M 16 4 C 9.382813 4 4 9.382813 4 16 C 4 22.617188 9.382813 28 16 28 C 22.617188 28 28 22.617188 28 16 C 28 9.382813 22.617188 4 16 4 Z M 16 6 C 21.535156 6 26 10.464844 26 16 C 26 21.535156 21.535156 26 16 26 C 10.464844 26 6 21.535156 6 16 C 6 10.464844 10.464844 6 16 6 Z M 15 8 L 15 17 L 22 17 L 22 15 L 17 15 L 17 8 Z"
                            stroke-linecap="round" />
                    </g>
                </svg>
                    `
                }
                        <span class="text-sm">${med.name}</span>
                    </div>
                    <div class="text-xs text-gray-500">${med.time}</div>
                `;

            container.appendChild(div);
        });

        // Re-initialize Lucide icons
    }

    // Toggle details row visibility
    function toggleDetails(id) {
        const detailsRow = document.querySelector(`.details-row[data-id="${id}"]`);
        const button = document.querySelector(`.details-btn[data-id="${id}"]`);

        if (detailsRow.classList.contains('hidden')) {
            detailsRow.classList.remove('hidden');
            button.innerHTML = `Less <svg id='Chevron_Up_24'  class="ml-1 h-4 w-4"  fill='currentcolor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.83 0 0 0.83 12 12)" >
                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: nonzero; opacity: 1;" transform=" translate(-15, -14.5)" d="M 27 18 L 27 20 C 27 20.386 26.777 20.738 26.428 20.904 C 26.079 21.07 25.666 21.019 25.366 20.774 L 15 12.292 L 4.633 20.774 C 4.334 21.019000000000002 3.9210000000000003 21.069000000000003 3.5709999999999997 20.904 C 3.221 20.739 3 20.386 3 20 L 3 18 C 3 17.7 3.135 17.416 3.367 17.226 L 14.367 8.225999999999999 C 14.736 7.924999999999999 15.265 7.924999999999999 15.634 8.225999999999999 L 26.634 17.226 C 26.865 17.416 27 17.7 27 18 z" stroke-linecap="round" />
                    </g>
                </svg>`;
        } else {
            detailsRow.classList.add('hidden');
            button.innerHTML = `Details 
                
                <svg id='Chevron_Down_24' class="ml-1 h-4 w-4"  fill='currentcolor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
                    <g transform="matrix(0.83 0 0 0.83 12 12)" >
                    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-15, -15.5)" d="M 3 12 L 3 10 C 3 9.614 3.223 9.262 3.572 9.096 C 3.9210000000000003 8.93 4.334 8.981 4.634 9.226 L 15 17.708 L 25.367 9.225999999999999 C 25.666 8.981 26.079 8.931 26.429000000000002 9.095999999999998 C 26.779 9.261 27 9.614 27 10 L 27 12 C 27 12.3 26.865 12.584 26.633 12.774000000000001 L 15.633 21.774 C 15.264 22.075 14.735 22.075 14.366 21.774 L 3.3659999999999997 12.774000000000001 C 3.135 12.584 3 12.3 3 12 z" stroke-linecap="round" />
                    </g>
                </svg>

                
                
                </i>`;
        }

        // Re-initialize Lucide icons
    }

    // Tab switching
    document.getElementById('tab-active').addEventListener('click', function () {
        this.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
        this.classList.remove('text-gray-500');

        document.getElementById('tab-history').classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
        document.getElementById('tab-history').classList.add('text-gray-500');

        document.getElementById('active-prescriptions-table').classList.remove('hidden');
        document.getElementById('history-prescriptions-table').classList.add('hidden');
    });

    document.getElementById('tab-history').addEventListener('click', function () {
        this.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
        this.classList.remove('text-gray-500');

        document.getElementById('tab-active').classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
        document.getElementById('tab-active').classList.add('text-gray-500');

        document.getElementById('history-prescriptions-table').classList.remove('hidden');
        document.getElementById('active-prescriptions-table').classList.add('hidden');
    });

    // Initialize the dashboard
    document.addEventListener('DOMContentLoaded', function () {
        renderActivePrescriptions();
        renderHistoryPrescriptions();
        renderTodayMedications();
    });
</script>









<script>

    dashboard_nav_all = document.querySelectorAll('.prescriptions-nav a');
    console.log(dashboard_nav_all);
    dashboard_nav_all.forEach((nav) => {
        nav_innertab =
            nav.classList.add('border-l-4', 'border-blue-500', 'bg-blue-50', 'rounded');
    });
</script>
{% endblock scripts %}